{"version":3,"sources":["../src/control.js"],"names":["define","$","Log","PubSub","EmergencyalertControl","region","self","prototype","main","body","block","closest","hasClass","data","addClass","detach","prepend","page","navleft","navtop","height","css","subscribe","debug","window","scrollTo","init","instanceid","first","length","control"],"mappings":"AA2BAA,OAAM,kCAAC,CAAC,QAAD,CAAW,UAAX,CAAuB,aAAvB,CAAD,CAAwC,SAASC,CAAT,CAAYC,CAAZ,CAAiBC,CAAjB,CAAyB,CACnE,aAyBA,QAASC,CAAAA,CAAT,CAAgCC,CAAhC,CAAwC,CACpC,GAAIC,CAAAA,CAAI,CAAG,IAAX,CACAA,CAAI,CAACD,MAAL,CAAcA,CACjB,CAMFD,CAAsB,CAACG,SAAvB,CAAiCC,IAAjC,CAAwC,UAAY,IAC3CF,CAAAA,CAAI,CAAG,IADoC,CAG3CG,CAAI,CAAGR,CAAC,CAAC,MAAD,CAHmC,CAI3CS,CAAK,CAAGJ,CAAI,CAACD,MAAL,CAAYM,OAAZ,CAAoB,+BAApB,CAJmC,CAM/C,GAAK,CAAEF,CAAI,CAACG,QAAL,CAAc,SAAd,CAAF,EAA8BN,CAAI,CAACD,MAAL,CAAYQ,IAAZ,CAAiB,YAAjB,CAAnC,CAAoE,CAChEH,CAAK,CAACI,QAAN,CAAe,QAAf,EACAL,CAAI,CAACK,QAAL,CAAc,sBAAd,EACAJ,CAAK,CAACK,MAAN,GACAN,CAAI,CAACO,OAAL,CAAaN,CAAb,EAJgE,GAM5DO,CAAAA,CAAI,CAAGhB,CAAC,CAAC,OAAD,CANoD,CAO5DiB,CAAO,CAAGjB,CAAC,CAAC,aAAD,CAPiD,CAQ5DkB,CAAM,CAAGlB,CAAC,CAAC,SAAD,CARkD,CAU5DmB,CAAM,CAAGV,CAAK,CAACU,MAAN,EAVmD,CAWhEH,CAAI,CAACI,GAAL,CAAS,YAAT,CAAuBD,CAAM,CAACD,CAAM,CAACC,MAAP,EAA9B,EACA,GAAIC,CAAAA,CAAG,CAAG,CACN,aAAeD,CADT,CAEN,SAAa,UAFP,CAAV,CAIAF,CAAO,CAACG,GAAR,CAAYA,CAAZ,EACAF,CAAM,CAACE,GAAP,CAAWA,CAAX,CACH,CAGDlB,CAAM,CAACmB,SAAP,CAAiB,uBAAjB,CAA0C,UAAY,CAClD,GAAIb,CAAI,CAACG,QAAL,CAAc,sBAAd,CAAJ,CAA2C,CACvCV,CAAG,CAACqB,KAAJ,CAAU,kBAAV,EACAC,MAAM,CAACC,QAAP,CAAgB,CAAhB,CAAmB,CAAnB,CACH,CACJ,CALD,CAMH,CAjCF,CAmCC,MAAO,CACHC,IAAI,CAjER,SAAcC,CAAd,CAA0B,CACtBzB,CAAG,CAACqB,KAAJ,CAAU,yDAA2DI,CAArE,EAEA,GAAItB,CAAAA,CAAM,CAAGJ,CAAC,CAAC,kDAAmD0B,CAAnD,CAA+D,KAAhE,CAAD,CAAuEC,KAAvE,EAAb,CAEA,GAAI,CAACvB,CAAM,CAACwB,MAAZ,CAAoB,CAChB3B,CAAG,CAACqB,KAAJ,CAAU,4DAAV,EACA,MACH,CAED,GAAIO,CAAAA,CAAO,CAAG,GAAI1B,CAAAA,CAAJ,CAA2BC,CAA3B,CAAd,CACAyB,CAAO,CAACtB,IAAR,EACH,CAoDM,CAGV,CAzEK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Provides the block_emergency_alerts/control module\r\n *\r\n * @package   block_emergency_alerts\r\n * @category    output\r\n * @copyright 2019 Michael Vangelovski, Canberra Grammar School <michael.vangelovski@cgs.act.edu.au>\r\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\n/**\r\n * @module block_emergency_alerts/control\r\n */\r\ndefine(['jquery', 'core/log', 'core/pubsub'], function($, Log, PubSub) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Initializes the block controls.\r\n     */\r\n    function init(instanceid) {\r\n        Log.debug('block_emergency_alerts/control: initializing instance ' + instanceid);\r\n\r\n        var region = $('[data-region=\"block_emergency_alerts-instance-' + instanceid +'\"]').first();\r\n\r\n        if (!region.length) {\r\n            Log.debug('block_emergency_alerts/control: wrapping region not found!');\r\n            return;\r\n        }\r\n\r\n        var control = new EmergencyalertControl(region);\r\n        control.main();\r\n    }\r\n\r\n    /**\r\n     * Controls a single my_day_timetable block instance contents.\r\n     *\r\n     * @constructor\r\n     * @param {jQuery} region\r\n     */\r\n    function EmergencyalertControl(region) {\r\n        var self = this;\r\n        self.region = region;\r\n    }\r\n\r\n    /**\r\n     * Run the controller.\r\n     *\r\n     */\r\n   EmergencyalertControl.prototype.main = function () {\r\n        var self = this;\r\n\r\n        var body = $('body');\r\n        var block = self.region.closest('.block.block_emergency_alerts');\r\n\r\n        if ( ! body.hasClass('editing') && self.region.data('numalerts') ) {\r\n            block.addClass('active');\r\n            body.addClass('has-emergency-alert');\r\n            block.detach();\r\n            body.prepend(block);\r\n\r\n            var page = $('#page');\r\n            var navleft = $('#nav-drawer');\r\n            var navtop = $('.navbar'); \r\n\r\n            var height = block.height();\r\n            page.css('margin-top', height+navtop.height());\r\n            var css = {\r\n                'margin-top' : height,\r\n                'position' : 'absolute',\r\n            };\r\n            navleft.css(css);\r\n            navtop.css(css);\r\n        }\r\n\r\n        //Subscribe to nav drawer event\r\n        PubSub.subscribe('nav-drawer-toggle-end', function(el){\r\n            if (body.hasClass('has-emergency-alert')) {\r\n                Log.debug('scrolling to top');\r\n                window.scrollTo(0, 0);\r\n            }\r\n        });\r\n    };\r\n\r\n    return {\r\n        init: init\r\n    };\r\n});"],"file":"control.min.js"}